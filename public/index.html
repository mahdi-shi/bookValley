<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="assets/book-2-48.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="homeStyle.css">
    <title>bookValley</title>
</head>

<body>

    <div id="this" class="container-fruid homePage">

        <!-- navbar -->

        <div class="row col-12 align-self-start navBar">
            <div><img src="assets/book-2-48.png" alt="loading...">
                <ul class="siteName">
                    <li>
                        <p>Book</p>
                    </li>
                    <li>
                        <p>Valley</p>
                    </li>
                </ul>
            </div>
            <ul class="list">
                <li><a href="#">Home</a></li>
                <li><a href="signIn.html">Account</a></li>
                <li><a href="profile.html">Profile</a></li>
                <li><a href="#">Challenge</a></li>
                <li><a href="geners.html">Geners</a></li>
            </ul>
            <div class="bookSearchBox">
                <input id="bookSearchTxtBox" type="text" placeholder="Books/auotors...">
                <svg id="searchBoxBtn" xmlns="http://www.w3.org/2000/svg" width="25" height="25"
                    fill="rgb(201, 201, 201)" class="bi bi-search" viewBox="0 0 16 16">
                    <path
                        d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
                </svg>
            </div>
            <div id="profileIcon">
                <svg id="profileIconSvg" xmlns="http://www.w3.org/2000/svg" width="37" height="37"
                    fill="rgb(201, 201, 201)" class="bi bi-person-fill" viewBox="0 0 16 16">
                    <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3Zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                </svg>
                <img id="profIconPicture" alt="oops">
            </div>

            <p id="messageBox">Please fill the field</p>
        </div>

        <!-- header -->

        <div class="row header">
            <div class="explainationHeader">
                <ul>
                    <li>
                        <h2>Cosmus</h2>
                        <p>
                            Here you can find the book you want from your favorites authors in many genres, whether
                            scientific, philosophical, or novel .
                        </p>
                    </li>
                    <li>
                        <h2>Who knows!</h2>
                        <p>
                            Who can say who will be the next Mark Twain? You can publish your work on this site
                        </p>
                    </li>
                    <li>
                        <h2>About Psyche</h2>
                        <p>
                            How can you think that people like Freud and Jung and... were able to reach this level of
                            genius without studying day and night?
                        </p>
                    </li>
                    <li>
                        <h2>Reading</h2>
                        <p>
                            What can be better than reading a book by Charles Dickens on a rainy night with a lighted
                            candle ?
                        </p>
                    </li>
                </ul>
            </div>
            <div class="backGroundImgHeader">
                <ul>
                    <li> <img src="assets/charls1.png" width="400px" height="600px" alt="loading"></li>
                    <li> <img src="assets/sigmund.png" width="400px" height="520px" alt="loading"></li>
                    <li> <img src="assets/twin.png" width="400px" height="580px" alt="loading"></li>
                    <li> <img src="assets/tesla.png" width="600px" height="600px" alt="loading"></li>
                </ul>
            </div>
            <div class="littleImageHeader">
                <ul>
                    <li> <img src="assets/books2.png" style="transform: rotate(10deg);" width="250px" height="340px"
                            alt="loading"></li>
                    <li> <img src="assets/images.jfif" width="230px" height="330px" alt="loading"></li>
                    <li> <img src="assets/9780520343634.jpg" style="transform: translateY(-100px)" width="300px"
                            height="400px" alt="loading"></li>
                    <li style="margin-left: -100px;"><img src="assets/atom.png"
                            style="transform: translateY(-100px) rotate(-1deg)" width="500px" height="500px"
                            alt="loading"></li>
                </ul>
            </div>
            <div class="backGroundHeader"></div>
        </div>
        <div class="section row">
            <div class="searchPnl">
                <svg id="searchPnlCloseBtn" xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="#8c85ad"
                    class="bi bi-x-lg" viewBox="0 0 16 16">
                    <path
                        d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
                </svg>

                <ul class="firstList">

                </ul>
            </div>
            <div class="col-5 homePageShelvesBooksListText justify-content-center align-items-center my-5">
                <p class="my-5">Your Shelve's books,<br><span>if you have yet</span></p>
            </div>
            <div class="col-7 my-5" style="transform: translateY(50px);">
                <div class="homePageShelvesBooksList my-4 mx-4">

                </div>
            </div>

            <div class="col-12 recommendedBookListTitle">
                <p>Recommended</p>
            </div>
            <div class="col-10 recommendedBookList offset-1 my-5">
            </div>

            <div class="col-12 homePageGenersTitle my-5">
                <p>Geners</p>
            </div>
            <div class="col-4 offset-1 homePageGenersExplanation">
                <p>You can easily find the books you want by searching in your genres. <br> <br> and you can also find
                    your favorite author this way.</p>
                    <a href="geners.html"><button class="my-5">More</button></a>
            </div>
            <div class="col-6 homePageGenersImage">
                <img src="assets/books4.png" alt="">
            </div>

            <div class="col-12 writersPannelTitle">
                <p>Be a writer</p>
            </div>
            <div class="col-6 offset-1 writersPannelImage ">
                <img src="assets/quill4.png" alt="idk">
            </div>
            <div class="col-4 writersPannelExplanation ">
                <p>Why aren't you a writer? You can publish your book by going to the inserted page and become a new
                    author of our website. <br> <br> we put your book after analizing it into it's own gener to be
                    accessible for public.</p>
                <button class="my-5">More</button>
            </div>

            <div class="footer">
                <div class="backGroundFooter">
                </div>
                <div id="goUpBtn">
                    <a href="#this"> <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor"
                            class="bi bi-arrow-up-square" viewBox="0 0 16 16">
                            <path fill-rule="evenodd"
                                d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm8.5 9.5a.5.5 0 0 1-1 0V5.707L5.354 7.854a.5.5 0 1 1-.708-.708l3-3a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 5.707V11.5z" />
                        </svg>
                    </a>
                </div>
                <img class="quill" src="assets/quill1.png" alt="idk">
                <img class="footerLogo" src="assets/book-2-48.png" alt="idk">
                <ul>
                    <li>Book</li>
                    <li>Valley</li>
                </ul>
                <ul class="footerLsFirst">
                    <li><a href="#">gifs</a></li>
                    <li><a href="#">collection</a></li>
                    <li><a href="#">marks</a></li>
                </ul>
                <ul class="footerLsOne">
                    <li><a href="signUp.html">Account</a></li>
                    <li><a href="profile.html">Profile</a></li>
                    <li><a href="geners.html">Geners</a></li>
                </ul>
                <ul class="footerLsTwo">
                    <li><a href="#">Writing</a></li>
                    <li><a href="#">Challenge</a></li>
                </ul>
            </div>
        </div>

    </div>

</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>

    const profileIcon = document.querySelector("#profileIcon");
    const profileIconSvg = document.querySelector("#profileIconSvg");

    profileIcon.addEventListener("click", () => {
        window.location.assign("profile.html");
    })

    document.body.onload = async () => {
        const userName = localStorage.getItem("userTarget");

        if (userName == null) {
            profIconPicture.style.display = "none";
            profileIconSvg.style.display = "block";
        }
        else {
            const data = { userName }
            const options = {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            };

            const response = await fetch("/dataForProfile", options)
            const dataResponse = await response.json();

            if (dataResponse.image == null) {
                profIconPicture.style.display = "none";
                profileIconSvg.style.display = "block";
            }
            else {
                profIconPicture.style.display = "block";
                profIconPicture.src = dataResponse.image;
                profileIconSvg.style.display = "none";
            }
        }
    }
    const navBar = document.querySelector(".navBar")
    document.onscroll = () => {
        if (scrollY > 600) {
            navBar.style.backgroundColor = "#242131"
        }
        else {
            navBar.style.backgroundColor = "transparent"

        }
    }

    //searching stuff

    const searchPnl = document.querySelector(".searchPnl");
    const searchPnlCloseBtn = document.querySelector("#searchPnlCloseBtn");
    const bookSearchTxtBox = document.querySelector("#bookSearchTxtBox");
    const firstList = document.querySelector(".firstList");
    const messageBox = document.querySelector("#messageBox");

    searchBoxBtn.addEventListener("click", async () => {

        if (bookSearchTxtBox.value == null || bookSearchTxtBox.value == "") {
            messageBox.classList.add("messageBoxFadeInOut");
            setTimeout(() => {
                messageBox.classList.remove("messageBoxFadeInOut");
            }, 5000);
        }
        else {
            searchPnl.style.marginTop = "-100vh";
            searchPnl.style.opacity = "0.95";

            const response = await fetch("https://openlibrary.org/search.json?q=" + bookSearchTxtBox.value)
            const data = await response.json();

            const books = document.querySelectorAll(".li");

            if (books.length > 0) {
                for (let i = 0; i < books.length; i++) {
                    books[i].remove();
                }
            }

            for (let i = 0; i < data.docs.length; i++) {

                console.log(data.docs[i].title);

                let li = document.createElement("li");
                let div = document.createElement("div");
                let p = document.createElement("p");
                let img = document.createElement("img");

                let titlePara = document.createTextNode(data.docs[i].title);
                p.appendChild(titlePara);
                p.classList.add("bookTitle");
                img.classList.add("bookCover");
                if (data.docs[i].cover_i == null) {
                    img.src = "assets/images (1).jfif";
                }
                else {
                    img.src = "https://covers.openlibrary.org/b/id/" + data.docs[i].cover_i + "-M.jpg";
                }

                div.classList.add("books");
                div.appendChild(p);
                div.appendChild(img);
                div.style = "--i:" + i;
                li.classList.add("li");
                li.appendChild(div);
                firstList.appendChild(li)

            }
        }
    })

    bookSearchTxtBox.addEventListener("keydown", async (e) => {
    const keyName = e.key;
    if (keyName == "Enter") {
        if (bookSearchTxtBox.value == null || bookSearchTxtBox.value == "") {
            messageBox.classList.add("messageBoxFadeInOut");
            setTimeout(() => {
                messageBox.classList.remove("messageBoxFadeInOut");
            }, 5000);
        }
        else {
            searchPnl.style.marginTop = "-100vh";
            searchPnl.style.opacity = "0.95";

            const response = await fetch("https://openlibrary.org/search.json?q=" + bookSearchTxtBox.value)
            const data = await response.json();

            const books = document.querySelectorAll(".li");

            if (books.length > 0) {
                for (let i = 0; i < books.length; i++) {
                    books[i].remove();
                }
            }

            for (let i = 0; i < data.docs.length; i++) {

                console.log(data.docs[i].title);

                let li = document.createElement("li");
                let div = document.createElement("div");
                let p = document.createElement("p");
                let img = document.createElement("img");

                let titlePara = document.createTextNode(data.docs[i].title);
                p.appendChild(titlePara);
                p.classList.add("bookTitle");
                img.classList.add("bookCover");
                if (data.docs[i].cover_i == null) {
                    img.src = "assets/images (1).jfif";
                }
                else {
                    img.src = "https://covers.openlibrary.org/b/id/" + data.docs[i].cover_i + "-M.jpg";
                }

                div.classList.add("books");
                div.appendChild(p);
                div.appendChild(img);
                div.style = "--i:" + i;
                li.classList.add("li");
                li.appendChild(div);
                firstList.appendChild(li)

            }
        }
    }
})

    searchPnlCloseBtn.addEventListener("click", () => {
        searchPnl.style.marginTop = "-200vh";
        searchPnl.style.opacity = "0";
        bookSearchTxtBox.value = "";
        const books = document.querySelectorAll(".li");
        if (books.length > 0) {
            for (let i = 0; i < books.length; i++) {
                books[i].remove();
            }
        }

    })

    searchPnl.onscroll = () => {

        if (searchPnl.scrollTop > 100) {
            navBar.style.backgroundColor = "#242131";
        }
        if (searchPnl.scrollTop < 100) {
            navBar.style.backgroundColor = "transparent";
        }
    }

</script>

</html>